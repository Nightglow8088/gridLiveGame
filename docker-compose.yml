version: '3.8'

services:
  # åç«¯æœåŠ¡
  backend:
    build: .
    container_name: pupupu-backend
    environment:
      # ğŸ‘‡ ã€å…³é”®ä¿®æ”¹ã€‘ç¡¬ç¼–ç äº‘ç«¯ä¸“ç”¨æ•°æ®åº“åœ°å€ ğŸ‘‡
      # 1. æ•°æ®åº“åæ”¹ä¸º: pupupu_CLOUD_PROD (ä¸æœ¬åœ°éš”ç¦»)
      # 2. æœ«å°¾åŠ ä¸Š: &readPreference=primary (é˜²æ­¢ç¬ç§»)
      - SPRING_DATA_MONGODB_URI=mongodb+srv://kevinB:MtBBPyxpKRMpmfyG@livinggrid.0b3gdw8.mongodb.net/pupupu_CLOUD_PROD?appName=livingGrid&readPreference=primary

      # å¦‚æœä½ æœ‰ OpenAI/Azure çš„ Keyï¼Œä¹Ÿå¯ä»¥ç¡¬ç¼–ç åœ¨è¿™é‡Œï¼Œä¾‹å¦‚ï¼š
      # - AZURE_OPENAI_KEY=sk-xxxxxxxx

    expose:
      - "8080" # å†…éƒ¨ç«¯å£ï¼Œå®‰å…¨

  # å‰ç«¯æœåŠ¡
  frontend:
    build: ./client
    container_name: pupupu-frontend
    ports:
      - "8088:80" # å¯¹å¤–æš´éœ² 8088 ç«¯å£
    depends_on:
      - backend